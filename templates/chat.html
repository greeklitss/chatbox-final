<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
    <title>AkoY Me Chat</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='default_avatar.png') }}" type="image/png">
</head>

<body style="background-image: url('{{ url_for('static', filename='akoyme_background.png') }}'); 
             background-size: cover; 
             background-position: center;
             background-attachment: fixed;"> 
    
    <div class="header-tools">
        
        <audio id="audio-stream" 
               src="{{ url_for('radio_proxy') }}"loop preload="auto">
               controls loop preload="auto">
            Your browser does not support the audio element.
        </audio>

        <button id="admin-button" title="Admin Panel" style="display:none;"><i class="fas fa-tools"></i> Admin</button>
        
        <button id="notification-volume-button" title="Notification Sound ON/OFF"><i class="fas fa-bell"></i></button>
    </div>

    <div class="chat-container">

        <div class="chat-box" id="chat-box"> 
        </div>

        <div class="online-users-sidebar" id="online-users-list">
            <h4>Online Users (<span id="online-users-list">0</span>)</h4>
        </div>
    </div> 

    <div id="emoticon-selector" style="display:none; position:relative; max-width: 1200px; margin: 0 auto; z-index: 100;">
        <div class="emoticon-grid">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f602.png" data-code=":joy:" title=":joy:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f603.png" data-code=":smiley:" title=":smiley:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f609.png" data-code=":wink:" title=":wink:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f618.png" data-code=":kissing_heart:" title=":kissing_heart:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f633.png" data-code=":flushed:" title=":flushed:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f914.png" data-code=":thinking:" title=":thinking:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f621.png" data-code=":rage:" title=":rage:">
            
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f3a7.png" data-code=":headphones:" title=":headphones:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f3b5.png" data-code=":musical_note:" title=":musical_note:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f399.png" data-code=":microphone:" title=":microphone:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f4fb.png" data-code=":radio:" title=":radio:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/2764.png" data-code=":heart:" title=":heart:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f525.png" data-code=":fire:" title=":fire:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f44d.png" data-code=":thumbsup:" title=":thumbsup:">
            <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f44f.png" data-code=":clap:" title=":clap:">
        </div>
    </div>
    
    <div class="message-input-area">
        
        <button id="bold-button" title="Bold [b]"><i class="fas fa-bold"></i></button>
        <button id="italic-button" title="Italic [i]"><i class="fas fa-italic"></i></button>
        <button id="underline-button" title="Underline [u]"><i class="fas fa-underline"></i></button>
        <button id="size-button" title="Text Size"><i class="fas fa-text-height"></i></button>
        <button id="gif-button" title="GIF/Image Embed"><i class="fas fa-image"></i></button>
        
        <button id="color-picker-button" title="Text Color"><i class="fas fa-palette"></i></button>
        <input type="color" id="color-input" value="#FF0066" style="display: none;">
        
        <button id="emoticon-button" title="Emoticons"><i class="fas fa-smile-wink"></i></button>
        
        <textarea id="message-input" placeholder="Type your message..." rows="1"></textarea>
        
        <button id="send-button" title="Send (Enter)"><i class="fas fa-paper-plane"></i></button>
    </div>
    
    <script src="{{ url_for('static', filename='main.js') }}"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audio = document.getElementById('audio-stream');
            
            // Ρύθμιση έντασης του Web Radio
            if (audio) {
                audio.volume = 0.3; 
            }
            
            // ΕΛΕΓΧΟΣ ΡΟΛΟΥ ΧΡΗΣΤΗ ΓΙΑ ΤΟ ADMIN BUTTON
            const currentUserRole = "{{ user.role }}"; // Παίρνουμε τον ρόλο από το Flask
            const adminButton = document.getElementById('admin-button');

            if (adminButton && (currentUserRole === 'admin' || currentUserRole === 'owner')) {
                adminButton.style.display = 'inline-block';
                adminButton.addEventListener('click', () => {
                    window.location.href = '/admin';
                });
            }
        });
    </script>
</body>
</html>